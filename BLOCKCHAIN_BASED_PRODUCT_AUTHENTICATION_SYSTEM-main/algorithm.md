# Algorithm

## 1. Blockchain server

At first, the blockchain server should be running. Deploying a smart contract in the ethereum blockchain requires a lot of processes, more importantly, it requires actual ethereum. So that is completely unfeasible at the moment. So we need to use a local ethereum blockchain server emulator, called `ganache`. Running the script `npm run ganache` starts up that server.

## 2. Writing smart contracts

For our use case, a smart contract that can store the product data on the blockchain has to be created. The smart contract will use a map state variable to keep track of the products using its id. Only the manager (the first account generated by running `npm run ganache`) will be able to add the product to the blockchain. 

## 3. Deploying smart contract

Running the command `npm run migrate`, does the following things

1. Compiles the smart contract into machine code
2. Generates artifacts (abi) files
3. Deploys the smart contract into the blockchain

## 4. Loading smart contract

To call the methods on the smart contract, we need to fetch the smart contract by passing the generated abi and the contract's deployed address to the `web3` library.

## 5. Creating Product

To create a product the caller (manager) has to call the `addProduct` method of the smart contract, providing the following data

1. Product name
2. Product type
3. Product id (auto-generated)

## 6. Mechanism

As soon as the manager sends the product data:

1. The `addProduct` method on the smart contract is called.
2. A gas fee is paid by the manager as the transaction cost
3. The transaction is mined and a unique nonce value is generated along with the hash
4. The network waits for other transactions sent within the next 2 minutes and appends all incoming transactions in a block.
5. Once the 2 minute wait time is over creates a new block.
6. All the nodes in our local blockchain network verifies the block and sends confirmation through broadcasting
7. If 51% of the nodes agree it is appended to the blockchain

## 7. Fetching Product

The user can use an inbuilt QR scanner to fetch a product using its QR code or if they know the id of the product they can fetch it in that way as well. Internally it calls the `getProductById` method of the `ProductAuth` smart contract